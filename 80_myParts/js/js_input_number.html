<!DOCTYPE html>
<html lang="ja"><head><meta charset="UTF-8"><title>My Boiler Plate</title></head>
<body>

    <!-- 整数のみ(oninput でいいと思う。あと、patternでも問題ないか・・・。一応書いた) -->
    <input
        type="text"
        oninput="value=formatValidValueForDegradationInputTextIntOnly(value)"
        pattern="^[0-9]+$"
        maxlength="3"
        min="0"
        max="999"
        style="text-align:right; width:5em; height:1.4em"
        value="{{$detail.item_quantity}}"
        name="item_quantity_{{$detail.degradation_check_item_id}}"
        class="my-someclass"
        >


    <!-- 小数第一位まで許可（途中の入力段階を考慮するため、onchange で。） -->
    <input
        type="text"
        onchange="value=formatValidValueForDegradationInputText(value)"
        pattern="^[0-9]+$"
        maxlength="3"
        min="0"
        max="999"
        min="0"
        max="999"
        style="text-align:right; width:5em; height:1.4em"
        value="{{$detail.item_quantity}}"
        name="item_quantity_{{$detail.degradation_check_item_id}}"
        class="my-someclass"
        >

</form>
<script>
'use strict';

// テキスト入力項目の不正入力チェック
// （小数点第一位までの整数のみを許可）
function formatValidValueForFuncAInputText(value){

    // 整数 + 小数第一位まで
    if( value.match(/^[0-9]+\.?[0-9]?$/) ){
        if( parseFloat(value) < 0 ){
            // 負数入力時
            return 0;
        }else if( parseFloat(value) > 999 ){
            // 入力オーバー時（末尾に入力した分を受け付けない）
            return value.slice(0,3)
        }else{
            // 正常値
            return parseFloat(value)
        }
    }else if( value.match(/^[0-9]+\.[0-9]{2,}$/) ){
        // 整数 + 小数第二位以上
        return Math.floor(parseFloat(value) * 10) / 10
    }else{
    // その他不正な入力（数値以外など）
        return ""
    }

}
</script>
</body>
</html>
