Handsontable は、Next.js では使えない可能性がある

・使えないとしたら、使えない原因の究明
・使えない場合は、代替案の検討（スプレッドシートのような、結合や分割の操作が出来るライブラリ）
・それも見つからなかった場合、他のフレームワークの検討（Next.js 以外）

________________________________________________________________________

こんなの見つけました。

HandsontableをNextJSで利用しようとしたらWindow is not defined エラーになった
https://zenn.dev/masa_naga/articles/b949888aa80139


```
# before
import { HotTable } from "@handsontable/react";

# after
const HotTable = dynamic(() => import("@handsontable/react"), {
  ssr: false, // <- ここで ssr を無効にするオプションを渡す
});
```

そんな簡単な問題ではないという事でしょうか。
（バージョンによってはこれでも解決無い可能性がある？　Next.js のバージョン、React のバージョン、Handsontable のバージョン等）

サンプルでこんなの書いてみましたが、この時は CDNで Handsontable を使用しています。
https://kakisoft.github.io/PracticeJavaScript/ExcellikeUI/Handsontable/example01.html

Handsontable のバージョンが怪しい場合は、一旦 CDN経由で使用してみるのはどうでしょう。
（Next.js でそんなアプローチができるかは分かりませんが。）

________________________________________________________________________


SSRが起因であれば、↑の方法で行けるのでは？　と考えました。
https://github.com/vercel/next.js/issues/3535


________________________________________________________________________

React 公式でも使えるみたいですね。
https://reactjsexample.com/official-wrapper-of-handsontable-data-grid-for-react/

CDN経由でも使えるみたいです。

________________________________________________________________________

handsontable の issue より
https://github.com/handsontable/handsontable/issues/7445

ssr: false 解決出来たりできなかったり

________________________________________________________________________

### 1. Handsontableはブラウザ上で動作するJavaScriptライブラリであり、クライアントサイドでの使用を前提に作られている

 * Handsontableはブラウザ上でDOM操作やイベントハンドリングを行い、ブラウザのJavaScript環境に依存しています。
 * サーバーサイドレンダリング（SSR）では、通常、サーバーサイドでHTMLを生成しクライアントに渡しますが、この段階ではブラウザ環境は存在しません。
 * SSRでは初回のHTMLレンダリング時にクライアントサイドのJavaScriptコードは実行されないため、クライアントサイドのJavaScriptモジュールを直接読み込むことができません。
 * そのため、基本的にはサーバーサイドのJavaScript実行環境（Node.js）ではHandsontableを直接使用することはできません。
 * Handsontableをインポートするには、ウェブサイトが表示されてJavaScriptが実行されてからでなければならないため、サーバーサイドでの事前読み込みはできません。

### 2.Handsontableを動作させる方法

 * Next.jsはダイナミックインポートをサポートしており、JavaScriptモジュール（Reactコンポーネントを含む）を動的にインポートして使用することができます。
 * クライアントサイドでモジュールの遅延読み込みを行うことができます。ダイナミックインポートは、非同期にモジュールを取得するためにimport()関数を使用する仕組みです。
 * 今回はSSR時にクライアントサイドに依存するJavaScriptモジュールにアクセスしようとしたため、アクセスできずにコンパイルエラーが発生しました。
 * ダイナミックインポートには、SSRのタイミングでは対象を読み込まないオプションがあります。
 * これにより、特定のモジュールをSSR時に読み込まず、クライアントサイドでのみ読み込むように指定することができます。
 * この機能を利用して、コンポーネントがブラウザで表示された時点（JavaScriptの実行時）でのみHandsontableを読み込むように設定しました。これにより、問題なくHandsontableを使用することができます。

### 3. Arepoのスプレッドシート機能との比較

 * Handsontableは非常に多機能なため、一部の機能をArepoと同様に再現できると考えています。
 * セルの結合・解除やデザイン変更、セルの値変更前と変更後のデータを取得すること、UndoやRedoといった重要な機能は確認できました。
 * ただし、まだArepoの全ての機能を把握しているわけではないため、軽微な操作では気づけなかった機能などが存在する可能性があります。
 * この課題に関しては引き続き調査を進め、Arepoの機能を再現できるかどうかを確認していく予定です。

________________________________________________________________________

